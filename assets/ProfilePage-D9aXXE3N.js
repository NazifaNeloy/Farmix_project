import{j as e,t as u,e as N,D as w,W as k,v as z,w as S,x as D,h as B,y as p,z as A,B as L}from"./ui-BW4q4lGy.js";import{h as _,r as f}from"./vendor-CxeeMcKR.js";import{u as j,a as C,b as E}from"./index-B08RLEBq.js";import{D as P}from"./DashboardLayout-Me5dofxf.js";import"./firebase-BPVtm2U-.js";const g={harvest_hero:k,water_wizard:w,early_bird:N,default:u},M=({badges:r=[]})=>{const{t:m}=j();return!r||r.length===0?e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(u,{className:"text-gray-400",size:32})}),e.jsx("p",{className:"text-gray-500",children:"No badges yet. Start your journey!"})]}):e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-farm-green-900 mb-4",children:"Your Achievements"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:r.map((l,d)=>{const s=g[l.type]||g.default;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 bg-farm-green-100 rounded-full flex items-center justify-center mb-2 text-farm-green-700",children:e.jsx(s,{size:24})}),e.jsx("span",{className:"text-xs text-center font-medium text-gray-700",children:l.name})]},d)})})]})},T=()=>{const{userData:r,logout:m}=C(),{batches:l,scans:d}=E(),{t:s}=j(),b=_(),v=async()=>{await m(),b("/")},n=f.useMemo(()=>{const a=l.reduce((c,x)=>{const y=typeof x.weight=="string"?parseFloat(x.weight):x.weight||0;return c+y},0),t=d.filter(c=>c.result==="fresh").length,o=d.filter(c=>c.result==="rotten").length,i=[];return l.length>0&&i.push("first_harvest"),t>=5&&i.push("risk_expert"),a>1e3&&i.push("yield_master"),l.length>=10&&i.push("community_leader"),{totalSaved:a,freshScans:t,rottenScans:o,earnedBadges:i}},[l,d]),h=f.useMemo(()=>[...l.map(t=>({type:"batch",date:new Date(t.createdAt),data:t})),...d.map(t=>({type:"scan",date:new Date(t.timestamp||t.createdAt),data:t}))].sort((t,o)=>o.date-t.date).slice(0,5),[l,d]);return r?e.jsx(P,{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 md:hidden",children:[e.jsx("h1",{className:"text-2xl font-bold text-farm-dark",children:s("profile.title")}),e.jsx("button",{onClick:v,className:"p-2 text-red-500 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(z,{size:24})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-24 h-24 bg-farm-lime/20 rounded-full flex items-center justify-center text-farm-dark mb-4 overflow-hidden border-2 border-farm-lime",children:r.photoURL?e.jsx("img",{src:r.photoURL,alt:r.name,className:"w-full h-full object-cover"}):e.jsx(S,{size:48})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-farm-dark",children:r.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:s("profile.role")})]})]}),e.jsxs("div",{className:"space-y-4 border-t border-gray-100 pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(D,{size:20,className:"text-farm-dark"}),e.jsx("span",{children:r.phone})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx(B,{size:20,className:"text-farm-dark"}),e.jsx("span",{children:r.location||s("profile.locationNotSet")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-farm-lime text-farm-dark p-4 rounded-2xl text-center shadow-lg shadow-farm-lime/20",children:[e.jsxs("div",{className:"text-2xl font-bold mb-1",children:[n.totalSaved,"kg"]}),e.jsx("div",{className:"text-xs font-medium opacity-80",children:s("profile.stats.saved")})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-farm-dark mb-1",children:l.length}),e.jsx("div",{className:"text-xs text-gray-500",children:s("profile.stats.activeBatches")})]})]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsx(M,{badges:n.earnedBadges}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(p,{size:20,className:"text-farm-green-600"}),e.jsx("h3",{className:"font-bold text-farm-dark",children:s("profile.activity.title")})]}),e.jsx("div",{className:"space-y-4",children:h.length===0?e.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:s("profile.activity.empty")}):h.map((a,t)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:`p-2 rounded-full ${a.type==="batch"?"bg-emerald-100 text-emerald-600":"bg-blue-100 text-blue-600"}`,children:a.type==="batch"?e.jsx(A,{size:16}):e.jsx(p,{size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:a.type==="batch"?s("profile.activity.addedBatch").replace("{crop}",a.data.cropType||"Crop"):s("profile.activity.scannedCrop").replace("{status}",a.data.result==="fresh"?s("profile.activity.healthy"):s("profile.activity.riskDetected"))}),e.jsx("p",{className:"text-xs text-gray-500",children:a.date.toLocaleDateString()})]}),a.type==="scan"&&a.data.result==="rotten"&&e.jsx("div",{className:"px-2 py-1 bg-red-100 text-red-600 text-xs font-bold rounded",children:s("profile.activity.riskLabel")})]},t))})]}),n.rottenScans>0&&e.jsxs("div",{className:"bg-red-50 p-6 rounded-3xl border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-red-700",children:[e.jsx(L,{size:20}),e.jsx("h3",{className:"font-bold",children:s("profile.riskEvents.title")})]}),e.jsx("p",{className:"text-sm text-red-600 mb-4",children:s("profile.riskEvents.desc").replace("{count}",n.rottenScans)})]})]})]})]})}):e.jsx("div",{className:"p-8 text-center",children:s("profile.loading")})};export{T as default};
